# MCP 도구 문제 및 해결 기록

## 1. 문제 상황 요약

- **현상 1: Playwright 테스트 무한 재시작**
  - `converter/playwright_test.js`와 `generator/playwright_test.js` 실행 시, 대상 서버(localhost:3000, localhost:8080)에 연결하지 못해 `net::ERR_CONNECTION_REFUSED` 오류가 발생하며 테스트가 실패하고, 이로 인해 프로세스가 계속 재시작되는 루프에 빠졌습니다.

- **현상 2: 백그라운드 서버 실행 실패**
  - `npm run dev` (`converter` 프로젝트) 또는 `python3 minimal_server.py` (`generator` 프로젝트)를 백그라운드(`&`)에서 실행했을 때, 프로세스가 즉시 종료되거나 제대로 실행되지 않아 포트가 열리지 않았습니다.
  - 특히 `npm run dev`의 경우, `cd frontend && python3 -m http.server 3000` 스크립트가 백그라운드에서 안정적으로 동작하지 않았습니다.

- **문제점: 작업 멈춤 및 비효율적인 디버깅**
  - 명령어를 포그라운드에서 실행하면 터미널이 점유되어 작업이 멈춘 것처럼 보였고, 이를 해결하기 위해 백그라운드에서 실행하면 오류 추적이 어려워 같은 실수를 반복하는 문제가 발생했습니다.

## 2. 근본 원인 분석

- **불안정한 `npm` 스크립트 실행:** `npm`을 통해 다른 프로세스(`python3`)를 실행하고 이를 백그라운드로 전환하는 과정이 불안정했습니다. `npm` 자체가 자식 프로세스를 관리하는 방식 때문에, 백그라운드 전환 시 의도대로 동작하지 않은 것으로 추정됩니다.
- **잘못된 디버깅 접근:** 백그라운드 실행 실패 시, 로그 파일을 확인하는 대신 포그라운드 실행을 반복하며 터미널을 점유시키는 실수를 반복했습니다. 이는 근본 원인 파악을 지연시켰습니다.

## 3. 해결 방안

**핵심: `npm`을 거치지 않고, 각 서버를 직접 백그라운드에서 실행**

1.  **`converter` 서버 실행:**
    - **디렉토리:** `converter/frontend`
    - **명령어:** `python3 -m http.server 3000 &`
    - **설명:** `npm` 스크립트를 통하지 않고, `converter/frontend` 디렉토리에서 직접 파이썬 HTTP 서버를 백그라운드로 실행합니다.

2.  **`generator` 서버 실행:**
    - **디렉토리:** `generator`
    - **명령어:** `python3 minimal_server.py &`
    - **설명:** `generator` 디렉토리에서 직접 파이썬 서버를 백그라운드로 실행합니다.

3.  **실행 상태 검증:**
    - `lsof -i :3000` 및 `lsof -i :8080` 명령어를 사용하여 두 포트가 모두 `LISTEN` 상태인지 확인합니다.

4.  **Playwright 테스트 실행:**
    - 서버가 정상적으로 구동되는 것을 확인한 후에 `converter`와 `generator`의 Playwright 테스트를 각각 실행합니다.

## 4. 향후 작업 원칙

1.  **프로세스 직접 실행:** 외부 도구(npm 스크립트 등)를 통한 간접 실행이 실패할 경우, 해당 프로세스를 직접 실행하는 방식을 우선적으로 시도합니다.
2.  **백그라운드 작업 검증:** 백그라운드에서 프로세스를 실행한 후에는 반드시 `ps` 또는 `lsof`와 같은 명령어로 실제 프로세스가 실행 중이고, 의도한 포트에서 수신 대기하고 있는지 확인합니다.
3.  **로그 기반 디버깅:** 백그라운드 작업 실패 시, 출력을 파일로 리다이렉션(`> log.txt 2>&1`)하여 로그를 먼저 확인하고 원인을 분석합니다.
4.  **문서화:** 새로운 문제가 발생하고 해결했을 경우, 이 문서(`problem-mcp-tools.md`)에 지속적으로 기록하여 같은 실수를 반복하지 않도록 합니다.
